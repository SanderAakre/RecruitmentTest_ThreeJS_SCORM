(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{161:(e,t,n)=>{Promise.resolve().then(n.bind(n,7446))},7446:(e,t,n)=>{"use strict";let o,i,r,a;n.r(t),n.d(t,{default:()=>b});var s=n(5155),l=n(2115),d=n(7274),c=n(4971),u=n(6812),p=n(5447);let w=()=>{let[e,t]=(0,l.useState)({1:!1,2:!1,3:!1,4:!1,5:!1,6:!1,7:!1,8:!1}),[n,i]=(0,l.useState)("0/8 parts viewed");(0,l.useEffect)(()=>{var e;return(null===(e=window.pipwerks)||void 0===e?void 0:e.SCORM)?(console.log("SCORM API found, attempting to initialize connection."),pipwerks.SCORM.init()?console.log("SCORM initialized successfully."):console.error("SCORM initialization failed.")):console.error("SCORM API not found."),()=>{var e;(null===(e=window.pipwerks)||void 0===e?void 0:e.SCORM)&&pipwerks.SCORM.quit()}},[]),(0,l.useEffect)(()=>{o=e=>{r(e)}});let r=n=>{if(e[n])return;let o={...e,[n]:!0};t(o),d(n),a(Object.values(o).filter(e=>e).length)},a=e=>{if(8===e){var t,n;if(console.log("All parts viewed! Attempting to set SCORM status to completed."),i("Course completed!"),null===(t=document.querySelector(".course-status"))||void 0===t||t.classList.replace("bg-gray-700","bg-green-500"),null===(n=window.pipwerks)||void 0===n?void 0:n.SCORM){if(console.log("SCORM API found, checking connection activation status."),pipwerks.SCORM.connection.isActive)console.log("SCORM connection is active.");else if(console.log("SCORM connection is not active. Reinitializing connection."),!pipwerks.SCORM.init()){console.error("Failed to reinitialize SCORM connection.");return}pipwerks.SCORM.set("cmi.core.lesson_status","completed"),pipwerks.SCORM.save()}else console.error("SCORM API not found.")}else i("".concat(e,"/").concat(8," parts viewed"))},d=e=>{let t=document.querySelectorAll('[data-scorm-id="'.concat(e,'"]'));if(!t){console.error("Could not find icon elements for part:",e);return}t.forEach(e=>{e.style.width="".concat(.8*m,"px"),e.style.height="".concat(.8*m,"px");let t=e.querySelector("div");t&&(t.classList.remove("hidden"),t.style.pointerEvents="none")})};return(0,s.jsx)("div",{className:"course-status fixed top-4 right-4 bg-gray-700 text-white text-sm font-bold py-1 px-3 rounded-full shadow-lg transition-all duration-300 z-50",children:n})},m=32,f=!0;function h(){r&&(r.timeScale=f?1:-1,r.paused=!1,r.play(),a&&(a.textContent=f?"Extend Landing Gear":"Retract Landing Gear"),f=!f)}let g=new d.Pq0,v=new d.Pq0,y=()=>{let e=(0,l.useRef)(null),t=(0,l.useRef)(null),n=(0,l.useRef)(null),f=(0,l.useRef)(null);return(0,l.useEffect)(()=>{if(!t.current){console.error("Canvas element not found");return}let e=new d.Z58,s=new d.ubm(75,window.innerWidth/window.innerHeight,.1,1e3);s.position.z=20;let l=new d.JeP({canvas:t.current});l.setSize(window.innerWidth,window.innerHeight);let w=new c.N(s,l.domElement),y=new d.zD7;(function(e,t){t.setSize(window.innerWidth,window.innerHeight),t.shadowMap.enabled=!0,t.toneMapping=d.FV,t.toneMappingExposure=.8,t.outputColorSpace=d.er$;let n=new d.ZyN(0xfff2e6,7);n.position.set(2.2,6,3),n.castShadow=!0,n.shadow.mapSize.set(2048,2048),n.shadow.camera.near=0,n.shadow.camera.far=12,n.shadow.camera.left=-12,n.shadow.camera.right=12,n.shadow.camera.top=12,n.shadow.camera.bottom=-12,e.add(n);let o=new d.$p8(0xfff2e6,.1);e.add(o);let i=new d.BdL(t);new u.Y().load("./textures/Skybox1D_Tex.HDR",t=>{let n=i.fromEquirectangular(t).texture;e.background=n,e.environment=n,t.dispose()},void 0,e=>{console.error("Error loading HDR texture:",e)})})(e,l),(function(e,t){return new Promise((e,n)=>{let i=new p.B,r=new d.Tap,a=r.load("models/".concat(t,"/").concat(t,"_BaseColor.png"));a.flipY=!1;let s=r.load("models/".concat(t,"/").concat(t,"_Normal.png"));s.flipY=!1;let l=r.load("models/".concat(t,"/").concat(t,"_ORM.png"));l.flipY=!1;let c=new d.uSd({map:a,normalMap:s,roughnessMap:l,roughness:1.2,metalnessMap:l,metalness:1});i.load("models/".concat(t,"/").concat(t,".glb"),i=>{let r=i.scene,a=i.animations;r.traverse(e=>{e.isMesh&&(e.material=c,e.castShadow=!0,e.receiveShadow=!0,e.material.needsUpdate=!0)}),fetch("models/".concat(t,"/").concat(t,"_info.json")).then(e=>{if(!e.ok)throw Error("Failed to load JSON: ".concat(e.status));return e.json()}).then(t=>{t.forEach(e=>{let t=function(e){let t=new d.B69;t.name=e.id,t.position.set(e.position.x,e.position.y,e.position.z);let n=document.createElement("div");n.classList.add("absolute","bg-cover","cursor-pointer","rounded-full","opacity-0","transition-opacity","duration-200"),n.style.width="".concat(m,"px"),n.style.height="".concat(m,"px"),n.style.backgroundImage='url("textures/icon.png")';let i=document.createElement("div");return i.classList.add("absolute","inset-0","bg-gray-500","bg-opacity-50","rounded-full","hidden"),n.appendChild(i),n.dataset.id=e.id,n.dataset.wordpressLink=e.wordpressLink,n.dataset.scormId=e.scormId.toString(),n.addEventListener("click",e=>{let t=e.target,n=t.dataset.wordpressLink;n&&function(e){let t=document.createElement("div");t.classList.add("fixed","inset-0","bg-gray-800","bg-opacity-75","flex","items-center","justify-center","z-50");let n=document.createElement("div");n.classList.add("bg-white","rounded","shadow-lg","overflow-hidden","relative","w-full","max-w-2xl","h-3/4","flex","flex-col"),t.addEventListener("click",e=>{e.target===t&&t.remove()});let o=document.createElement("iframe");o.src=e,o.classList.add("w-full","h-full","flex-grow"),o.style.border="none",n.appendChild(o);let i=document.createElement("button");i.textContent="Close",i.classList.add("bg-gray-700","hover:bg-gray-900","text-white","font-bold","py-2","rounded","w-full","max-w-xs","mx-auto","mb-4","mt-2"),i.addEventListener("click",()=>{t.remove()}),n.appendChild(i),t.appendChild(n),document.body.appendChild(t)}(n);let i=Number(t.dataset.scormId);i&&(o?o(i):console.error("completePart function is not yet initialized."))}),document.body.appendChild(n),t.userData={iconElement:n,wordpressLink:e.wordpressLink,direction:new d.Pq0(e.direction.x,e.direction.y,e.direction.z)},t}(e);r.add(t)}),e({loadedModel:r,animations:a})}).catch(e=>{console.error("Error loading JSON:",e),n(e)})},void 0,e=>{console.error("Error loading model:",e),n(e)})})})(0,"airplane").then(t=>{let{loadedModel:o,animations:s}=t;f.current=o,e.add(o),function(e,t){e.minDistance=14,e.maxDistance=60,e.enablePan=!1,e.enableDamping=!0,e.dampingFactor=.05;let n=!1,o=null;function i(e){(2===e.button||e.ctrlKey||e.shiftKey)&&(n=!0,o={x:e.clientX,y:e.clientY})}function r(e){if(n&&o){let n={x:e.clientX-o.x,y:e.clientY-o.y};t.rotation.y+=.005*n.x,t.rotation.x+=.005*n.y,o={x:e.clientX,y:e.clientY}}}function a(){n=!1,o=null}window.addEventListener("mousedown",i),window.addEventListener("mousemove",r),window.addEventListener("mouseup",a),()=>{window.removeEventListener("mousedown",i),window.removeEventListener("mousemove",r),window.removeEventListener("mouseup",a)}}(w,o),n.current=function(e,t){return t&&0!==t.length?((r=(i=new d.Iw4(e)).clipAction(t[0])).clampWhenFinished=!0,r.setLoop(d.G3T,1),a||((a=document.createElement("button")).textContent="Retract Landing Gear",a.classList.add("fixed","bottom-4","right-4","bg-gray-700","text-white","py-2","px-4","rounded","shadow-lg","hover:bg-gray-900"),a.addEventListener("click",h),document.body.appendChild(a)),i):(console.error("No animations found in the model."),null)}(o,s)});let x=()=>{if(requestAnimationFrame(x),w.update(),f.current){var t;!function(e,t){let n=!t.position.equals(g),o=!e.position.equals(v);(n||o)&&(e.traverse(n=>{var o;n.isObject3D&&(null===(o=n.userData)||void 0===o?void 0:o.wordpressLink)&&function(e,t,n){let o=e.getWorldPosition(new d.Pq0),i=new d.Pq0().subVectors(t.position,o).normalize(),r=e.userData.direction.clone().applyQuaternion(n.quaternion),a=e.userData.iconElement;if(a){if(r.dot(i)>0){let n=o.clone().project(t),i=(.5*n.x+.5)*window.innerWidth,r=-(.5*n.y-.5)*window.innerHeight;a.style.left="".concat(i-m/2,"px"),a.style.top="".concat(r-m/2,"px"),a.classList.remove("opacity-0"),a.classList.add("opacity-100"),a.style.pointerEvents="auto",e.userData.isFadingOut=!1}else{if(!e.userData.isFadingOut){e.userData.isFadingOut=!0;let n=setInterval(()=>{if(0>=parseFloat(window.getComputedStyle(a).opacity))clearInterval(n),e.userData.isFadingOut=!1,a.style.pointerEvents="none";else{let e=o.clone().project(t),n=(.5*e.x+.5)*window.innerWidth,i=-(.5*e.y-.5)*window.innerHeight;a.style.left="".concat(n-m/2,"px"),a.style.top="".concat(i-m/2,"px")}},16)}a.classList.remove("opacity-100"),a.classList.add("opacity-0")}}}(n,t,e)}),g.copy(t.position),v.copy(e.position))}(f.current,s);let e=y.getDelta();null===(t=n.current)||void 0===t||t.update(e)}l.render(e,s)};x();let b=()=>{s.aspect=window.innerWidth/window.innerHeight,s.updateProjectionMatrix(),l.setSize(window.innerWidth,window.innerHeight)};return window.addEventListener("resize",b),()=>{window.removeEventListener("resize",b),w.dispose(),l.dispose()}},[]),(0,s.jsxs)("div",{ref:e,className:"relative w-full h-screen",children:[(0,s.jsx)("canvas",{ref:t,className:"w-full h-full"}),(0,s.jsx)(w,{})]})};var x=n(6584);function b(){return(0,s.jsxs)("div",{className:"h-screen w-screen",children:[(0,s.jsx)(x.default,{src:"./SCORM_API_wrapper.js",strategy:"beforeInteractive"}),(0,s.jsx)(y,{})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[367,309,441,517,358],()=>t(161)),_N_E=e.O()}]);